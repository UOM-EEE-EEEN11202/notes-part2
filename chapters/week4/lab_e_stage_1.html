<!DOCTYPE html>
<html class="no-js" lang="en-GB" data-content_root="../../">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>4.2.1. Numpy examples &mdash; notes-part2 0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="../../_static/uom_custom.css?v=79662979" />
      <link rel="stylesheet" type="text/css" href="../../_static/pygments-theme-light.css?v=5c77cf45" />
      <link rel="stylesheet" type="text/css" href="../../_static/pygments-theme-dark.css?v=54fad279" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
            <link rel="index" title="Index" href="../../genindex.html" />
            <link rel="search" title="Search" href="../../search.html" />
            <link rel="top" title="notes-part2 0.1 documentation" href="#" />
            <link rel="up" title="4.2. Lab E" href="lab_e.html" />
            <link rel="next" title="4.2.2. Scipy examples" href="lab_e_stage_2.html" />
            <link rel="prev" title="4.2. Lab E" href="lab_e.html" />
    </head>
<body>
    <script type="text/javascript" src="../../_static/dist/blocking.js"></script>
    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script>
        try {
            var font_store = localStorage.getItem('uom-sphinx-font');
            if (font_store.startsWith('"') && font_store.endsWith('"')) {
                localStorage.setItem('uom-sphinx-font', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
        try {
            var theme_store = localStorage.getItem('uom-sphinx-theme');
            if (theme_store.startsWith('"') && theme_store.endsWith('"')) {
                localStorage.setItem('uom-sphinx-theme', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>   
    <!-- Set font/code theme before content loads to prevent a flash --> 
    <script>
        var html = document.querySelector('html');
        var body   = document.querySelector('body');
        var font;
        try { font = localStorage.getItem('uom-sphinx-font'); } catch(e) { }
        if (font === null || font === undefined) { font = "font-roboto"; }
        if (font === "font-opendyslexic") {
            html.classList.remove('font-alt');
            body.classList.remove('font-alt');
        } else {
            html.classList.add('font-alt');
            body.classList.add('font-alt');
        }
        try { theme = localStorage.getItem('uom-sphinx-theme'); } catch(e) { }
        if (theme === null || theme === undefined) { theme = "theme-light"; }
        if (theme === "theme-dark") {
                html.classList.remove('theme-light');
                body.classList.remove('theme-light');
                html.classList.add('theme-dark');
                body.classList.add('theme-dark');
            } else {
                html.classList.remove('theme-dark');
                body.classList.remove('theme-dark');
                html.classList.add('theme-light');
                body.classList.add('theme-light');
            }
        </script>
    <header id="uom_header_title" class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="/"
                        title="University of Manchester logo"
                        class="logo navbar-brand"
                    >
                        <img src="../../_static/./img/uom_logo_white.png" width="88" alt="University of Manchester logo"
                            class="logo-img"
                        />
                        EEEN11202 course notes
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="../../search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search notes part 2" aria-label="Search notes" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">0. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1_intro.html">1. Week 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week1/theory.html">1.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week1/formative_quiz.html">1.2. Formative quiz 1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week2_intro.html">2. Week 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week2/theory.html">2.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week2/lab_a.html">2.2. Lab A</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week2/lab_a_stage_1.html">2.2.1. Shell scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week2/lab_a_stage_2.html">2.2.2. Version control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week2/assignment_a.html">2.2.3. Assignment A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week2/lab_b.html">2.3. Lab B</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week2/lab_b_stage_1.html">2.3.1. Virtual environments and Jupyter notebooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week2/lab_b_stage_2.html">2.3.2. Electronic Engineering examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week2/assignment_b.html">2.3.3. Assignment B</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week2/formative_quiz.html">2.4. Formative quiz 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week3_intro.html">3. Week 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week3/theory.html">3.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week3/lab_c.html">3.2. Lab C</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week3/lab_c_stage_1.html">3.2.1. Python projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week3/lab_c_stage_2.html">3.2.2. Common Python commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week3/assignment_c.html">3.2.3. Assignment C</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week3/lab_d.html">3.3. Lab D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week3/lab_d_stage_1.html">3.3.1. Tools and techniques for catching coding issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week3/lab_d_stage_2.html">3.3.2. Unit testing with Pytest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week3/assignment_d.html">3.3.3. Assignment D</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week3/formative_quiz.html">3.4. Formative quiz 3</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../week4_intro.html">4. Week 4</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory.html">4.1. Theory</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="lab_e.html">4.2. Lab E</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.2.1. Numpy examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="lab_e_stage_2.html">4.2.2. Scipy examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="assignment_e.html">4.2.3. Assignment E</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lab_f.html">4.3. Lab F</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lab_f_stage_1.html">4.3.1. Plotting with plotly and matplotlib</a></li>
<li class="toctree-l3"><a class="reference internal" href="lab_f_stage_2.html">4.3.2. Polars examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="assignment_f.html">4.3.3. Assignment F</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="formative_quiz.html">4.4. Formative quiz 4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week5_intro.html">5. Week 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week5/theory.html">5.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week5/lab_g.html">5.2. Lab G</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week5/lab_g_stage_1.html">5.2.1. Objects and classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week5/lab_g_stage_2.html">5.2.2. Multi-file scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week5/assignment_g.html">5.2.3. Assignment G</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week5/lab_h.html">5.3. Lab H</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week5/lab_h_stage_1.html">5.3.1. Exceptions and error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week5/lab_h_stage_2.html">5.3.2. Git branches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week5/assignment_h.html">5.3.3. Assignment H</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week5/formative_quiz.html">5.4. Formative quiz 5</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week6_intro.html">6. Week 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week6/theory.html">6.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week6/lab_i.html">6.2. Lab I</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week6/lab_i_stage_1.html">6.2.1. Writing code for AI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week6/lab_i_stage_2.html">6.2.2. Using AI for coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week6/assignment_i.html">6.2.3. Assignment I</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week6/lab_j.html">6.3. Lab J</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../week6/lab_j_stage_1.html">6.3.1. What comes next</a></li>
<li class="toctree-l3"><a class="reference internal" href="../week6/assignment_j.html">6.3.2. Assignment J</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../week6/formative_quiz.html">6.4. Formative quiz 6</a></li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div><div>
  <p>
    <img src="https://assets.manchester.ac.uk/logos/hi-res/TAB_UNI_MAIN_logo/White_backgrounds/TAB_col_white_background.png" alt="University of Manchester logo" style="width: 100vw; min-width: 100px;">
  </p>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header id="uom_header_buttons" class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../../index.html">Part 2</a></li>
            <li class="breadcrumb-item"><a href="../week4_intro.html"><span class="section-number">4. </span>Week 4</a></li>
            <li class="breadcrumb-item"><a href="lab_e.html"><span class="section-number">4.2. </span>Lab E</a></li>
        <li class="breadcrumb-item active" aria-current="page"><span class="section-number">4.2.1. </span>Numpy examples</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
                        <button id="uom_alt_font_button" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="alt-only"><i class="fas fa-strikethrough"></i> Default font</span>
                            <span class="default-only"><i class="fas fa-font"></i> OpenDyslexic font</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/UOM-EEE-EEEN11202/notes-part2/tree/main/docs/chapters/week4/lab_e_stage_1.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../../_sources/chapters/week4/lab_e_stage_1.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="numpy-examples">
<span id="lab-e-stage-1"></span><h1><span class="section-number">4.2.1. </span>Numpy examples<a class="headerlink" href="#numpy-examples" title="Link to this heading">¶</a></h1>
<section id="initial-setup-for-the-lab">
<h2><span class="section-number">4.2.1.1. </span>Initial setup for the Lab<a class="headerlink" href="#initial-setup-for-the-lab" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>In the VSCode terminal enter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1"><span class="nb">cd</span><span class="w"> </span>/workspaces/<span class="sb">`</span>ls<span class="w"> </span>/workspaces<span class="sb">`</span>/lab-e</span>
<span class="prompt1">uv<span class="w"> </span>init<span class="w"> </span>.</span>
</pre></div></div><p>Remember to enter these one at a time, not both together.</p>
<p>This will make a new Python project in the current folder. It will be named automatically after the folder name.</p>
<p>To analyze these lines:</p>
<ul class="simple">
<li><p><code class="code highlight console docutils literal highlight-console"><span class="go">cd /workspaces/`ls /workspaces`/lab-e</span></code> makes sure we are working in the lab-e folder.</p></li>
<li><p><code class="code highlight console docutils literal highlight-console"><span class="go">uv init .</span></code> is the interesting command. This actually sets up our virtual environment.</p></li>
</ul>
<p>The above will make the a <code class="code highlight console docutils literal highlight-console"><span class="go">pyproject.toml</span></code> file, a <code class="code highlight console docutils literal highlight-console"><span class="go">main.py</span></code> file, and a number of others.</p>
</li>
<li><p>Add some structure to your code folder by entering the commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">mkdir<span class="w"> </span>tests<span class="w"> </span>docs</span>
<span class="prompt1">mv<span class="w"> </span>main.py<span class="w"> </span>src</span>
<span class="prompt1">uv<span class="w"> </span>run<span class="w"> </span>src/main.py</span>
<span class="prompt1">touch<span class="w"> </span>tests/__init__.py</span>
</pre></div></div><ul class="simple">
<li><p>Here we’ve moved <code class="code highlight console docutils literal highlight-console"><span class="go">main.py</span></code> into the <code class="code highlight console docutils literal highlight-console"><span class="go">src</span></code> folder. You’ll see that the <code class="code highlight console docutils literal highlight-console"><span class="go">src</span></code> folder already contains some code that we’ve written for you.</p></li>
<li><p>We’ve made a <code class="code highlight console docutils literal highlight-console"><span class="go">tests</span></code> folder for any tests that we might want to write later, and a <code class="code highlight console docutils literal highlight-console"><span class="go">docs</span></code> folder for any documentation. We won’t ask you to put anything into these as part of the lab instructions, but you might want to write some tests for your code to check that it’s working!</p></li>
<li><p>In the files that were downloaded from Git automatically, you’ll also see there’s a folder called <code class="code highlight console docutils literal highlight-console"><span class="go">data</span></code>. This contains some files that we’ll analyze during the lab.</p></li>
</ul>
</li>
<li><p>Install the required dependencies for this lab by entering the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">uv<span class="w"> </span>add<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>pandas<span class="w"> </span>plotly</span>
</pre></div></div></li>
<li><p>Run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">uv<span class="w"> </span>run<span class="w"> </span>src/main.py</span>
</pre></div></div><p>to make sure the virtual environment is built.</p>
</li>
<li><p>When you open a Python file, make sure that the correct Python virtual environment is activated. See the instructions <a class="reference external" href="https://uom-eee-eeen11202.github.io/notes-part2/chapters/week3/lab_d_stage_1.html#">in Lab D</a> if you’re unsure.</p></li>
</ol>
</section>
<section id="numerical-analysis-in-python">
<h2><span class="section-number">4.2.1.2. </span>Numerical analysis in Python<a class="headerlink" href="#numerical-analysis-in-python" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Make a new Python file with any suitable name. Put it in your Lab E <code class="code highlight console docutils literal highlight-console"><span class="go">src</span></code> folder.</p></li>
<li><p>In this file, copy the code below and run it. We suggest putting a breakpoint on the <code class="code highlight python docutils literal highlight-python"><span class="k">return</span></code> statement on Line 13 so you can view the results, or you can inset <code class="code highlight python docutils literal highlight-python"><span class="n">logging</span></code> commands if you prefer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">def</span><span class="w"> </span><span class="nf">vector_and_matrix_multiplication</span><span class="p">():</span>
    <span class="c1"># Define vectors</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

    <span class="c1"># Perform vector-matrix multiplication</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>  <span class="c1"># dot product</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>  <span class="c1"># cross product</span>

    <span class="k">return</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">vector_and_matrix_multiplication</span><span class="p">()</span>
</pre></div>
</div>
<p>The view in the debugger will be like the below.</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/vector_products.png"><img alt="View if the VSCode debugger" src="../../_images/vector_products.png" width="800" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot of VSCode, software from <a class="reference external" href="https://code.visualstudio.com/">Microsoft</a>. See <a class="reference external" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright">course copyright statement</a>.</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>From your Maths courses you should remember multiplying vectors, where you can use the dot product to get a scalar result, or the cross product to get another vector. <code class="code highlight python docutils literal highlight-python"><span class="n">numpy</span></code> makes this very easy.</p>
<p>To analyze the code briefly:</p>
<ul class="simple">
<li><p><code class="code highlight python docutils literal highlight-python"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span></code> adds the numpy library to the code. Functions have a <a class="reference external" href="https://uom-eee-eeen11202.github.io/notes-part1/chapters/programming_fundamentals/scope.html#namespaces">namespace</a>, essentially an address to the function so that functions with the same name don’t conflict with one another. By importing numpy as <code class="code highlight python docutils literal highlight-python"><span class="n">np</span></code>, we can use the shorter <code class="code highlight python docutils literal highlight-python"><span class="n">np</span></code> prefix to access functions in the numpy library.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">])</span></code> creates a numpy array. These are 1D arrays, and so they are representing vectors. <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">])</span></code> is not one of the built in <a class="reference external" href="https://uom-eee-eeen11202.github.io/notes-part1/chapters/programming_fundamentals/data_types.html">data types</a> in Python, numpy has added it.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">()</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">()</span></code> are then the numpy functions for calculating the dot product and cross products respectively.</p></li>
</ul>
</li>
<li><p>To work with matrices, we can make 2D arrays. Add the code below to the <code class="code highlight python docutils literal highlight-python"><span class="n">vector_and_matrix_multiplication</span><span class="p">()</span></code> function, and run it again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define matrices</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Perform matrix multiplication</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">@</span> <span class="n">m2</span>  <span class="c1"># matrix multiplication</span>
<span class="n">r4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>  <span class="c1"># alternative method</span>
</pre></div>
</div>
<p>You should see the result of the matrix multiplication in the debugger view.</p>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="../../_images/matrix_multiplication.png"><img alt="View of the VSCode debugger" src="../../_images/matrix_multiplication.png" width="800" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot of VSCode, software from <a class="reference external" href="https://code.visualstudio.com/">Microsoft</a>. See <a class="reference external" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright">course copyright statement</a>.</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>This defines two 3x3 matrices, and then performs a matrix multiplication. There are two different syntaxes, both of which give the same result. <code class="code highlight python docutils literal highlight-python"><span class="o">@</span></code> is just a short hand as multiplying matrices is a common thing to want to do.</p>
</li>
<li><p>In many engineering applications, we need to solve systems of linear equations. These are equations like the below. The aim is to find the value of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<p>where for example</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}A &amp;= \begin{bmatrix}
     1 &amp; 2 &amp; 3 \\
     1 &amp; 0 &amp; 1 \\
     3 &amp; 1 &amp; 3
     \end{bmatrix}, \\\end{split}\\\begin{split} b &amp;= \begin{bmatrix}
      5 \\
      3 \\
      3
      \end{bmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>By searching the Internet, asking AI, or similar, add code to your <code class="code highlight python docutils literal highlight-python"><span class="n">vector_and_matrix_multiplication</span><span class="p">()</span></code> function to work out the value of <span class="math notranslate nohighlight">\(x\)</span> for the <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(b\)</span> given above.</p>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve linear equations</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">@</span> <span class="n">b</span>  <span class="c1"># alternative method</span>
</pre></div>
</div>
<p>Again solving linear systems is quite a common thing to do, and so it’s got it own dedicated function in numpy, <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span></code>. An alternative method is to calculate the inverse of <span class="math notranslate nohighlight">\(A\)</span> using <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span></code>, and then multiply it by <span class="math notranslate nohighlight">\(b\)</span>. Both methods give the same result.</p>
</div>
</li>
<li><p>What is the value of <span class="math notranslate nohighlight">\(x\)</span> when</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}A &amp;= \begin{bmatrix}
     2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
     1 &amp; 2 &amp; 1 &amp; 0 &amp; 0 \\
     0 &amp; 1 &amp; 2 &amp; 1 &amp; 0 \\
     0 &amp; 0 &amp; 1 &amp; 2 &amp; 1 \\
     0 &amp; 0 &amp; 0 &amp; 1 &amp; 2
     \end{bmatrix}, \\\end{split}\\\begin{split} b &amp;= \begin{bmatrix}
      1 \\
      1 \\
      1 \\
      1 \\
      1
      \end{bmatrix}\end{split}\end{aligned}\end{align} \]</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="math notranslate nohighlight">
\[\begin{split}x &amp;= \begin{bmatrix}
     0.5 \\
     0 \\
     0.5 \\
     0 \\
     0.5
     \end{bmatrix}\end{split}\]</div>
</div>
</li>
</ol>
</section>
<section id="simulating-signals-in-python">
<h2><span class="section-number">4.2.1.3. </span>Simulating signals in Python<a class="headerlink" href="#simulating-signals-in-python" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>In your Lab E <code class="code highlight console docutils literal highlight-console"><span class="go">src</span></code> folder we’ve placed a Python file called <code class="code highlight console docutils literal highlight-console"><span class="go">sine_plotting.py</span></code>. Open this file.</p>
<p>It contains a function called <code class="code highlight python docutils literal highlight-python"><span class="n">make_sine_wave</span><span class="p">()</span></code>, shown below. It’s a minor variant on the code we introduced in <a class="reference external" href="https://uom-eee-eeen11202.github.io/notes-part2/chapters/week2/lab_b_stage_2.html">Lab B</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_sine_wave</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a sine wave signal</span>
<span class="sd">    TO DO: replace range with a numpy array</span>

<span class="sd">    Returns: t: time samples</span>
<span class="sd">    v_out: voltage samples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sample_start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sample_stop</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Volts</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Hz</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">sample_start</span><span class="p">,</span> <span class="n">sample_stop</span><span class="p">)</span>  <span class="c1"># interpret as representing 1 s, 2 s, 3 s, ...</span>
    <span class="n">v_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">v_out</span>
</pre></div>
</div>
<p>This code is not ideal, because <code class="code highlight python docutils literal highlight-python"><span class="nb">range</span><span class="p">()</span></code> can only generate whole numbers, which we have to interpret as representing seconds (1 s, 2 s, 3 s, …). Now we can make numpy arrays that can have numbers that we like. Also, it uses a <code class="code highlight python docutils literal highlight-python"><span class="k">for</span></code> loop to calculate the value of sin at each time sample. Numpy can do this sort of operation much more efficiently without needing a loop.</p>
</li>
<li><p>In <code class="code highlight console docutils literal highlight-console"><span class="go">sine_plotting.py</span></code> there is also a function called <code class="code highlight python docutils literal highlight-python"><span class="n">make_sine_wave_numpy</span><span class="p">()</span></code>. This is a version of the same function, but using numpy arrays. The code is given below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_sine_wave_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a sine wave signal</span>
<span class="sd">    Returns: t: time samples</span>
<span class="sd">    v_out: voltage samples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span>
    <span class="p">)</span>  <span class="c1"># interpret as representing 1 s, 2 s, 3 s, ...</span>
    <span class="n">v_out</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">v_out</span>
</pre></div>
</div>
<p>The key changes are:</p>
<ul class="simple">
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">t</span></code> is now made using <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">()</span></code>, which is similar to <code class="code highlight python docutils literal highlight-python"><span class="nb">range</span><span class="p">()</span></code>, but can have any step size. Here the step size is set to 30 samples per cycle of the sine wave, which makes a nice plot whatever value of <code class="code highlight python docutils literal highlight-python"><span class="n">f</span></code> is used.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span></code> has been replaced with <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span></code>. This can take a numpy array as the input, and will calculate the sin of each element in the array automatically. We don’t need a <code class="code highlight python docutils literal highlight-python"><span class="k">for</span></code> loop to cycle through every element in the array.</p></li>
</ul>
</li>
<li><p>In <code class="code highlight console docutils literal highlight-console"><span class="go">sine_plotting.py</span></code> there is also a function called <code class="code highlight python docutils literal highlight-python"><span class="n">plot_sine_wave</span><span class="p">()</span></code>. Add code to <code class="code highlight python docutils literal highlight-python"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span></code> to make a sine wave of amplitude 1 V, frequency 0.1 Hz, from time 0 s to 50 s, and then plot it. Do this using both <code class="code highlight python docutils literal highlight-python"><span class="n">make_sine_wave</span><span class="p">()</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">make_sine_wave_numpy</span><span class="p">()</span></code> to see the difference.</p>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Put plotting code below here</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Amplitude in V</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Frequency in Hz</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Start time in s</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Stop time in s</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">v_out</span> <span class="o">=</span> <span class="n">make_sine_wave</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
    <span class="n">do_plots</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v_out</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">v_out</span> <span class="o">=</span> <span class="n">make_sine_wave_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
    <span class="n">do_plots</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v_out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You should see plots like the below, where the bottom one is made using numpy.</p>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="../../_images/sine_waves.png"><img alt="Two plots of sine waves with plotly" src="../../_images/sine_waves.png" width="800" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot of a web browser, software from <a class="reference external" href="https://brave.com/">Brave</a>. See <a class="reference external" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright">course copyright statement</a>.</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><p>Experiment with different values of <code class="code highlight python docutils literal highlight-python"><span class="n">A</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">f</span></code> to see the different signals produced. If you make the frequency <code class="code highlight python docutils literal highlight-python"><span class="n">f</span></code> very high you might want to decrease the stop time to see just a few cycles of the sine wave.</p></li>
<li><p>An important feature of numpy is that it can operate on whole arrays at once. This is called <em>vectorization</em>. It saves us from having lots of <code class="code highlight python docutils literal highlight-python"><span class="k">for</span></code> loops which, by definition, need to be run multiple times and so can make the code slower to run.</p>
<p>Add the below to your code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for both sine waves - both need the same time base</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># sampling frequency in Hz</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Make sine wave 1</span>
<span class="n">A1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">f1</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>

<span class="c1"># Make sine wave 2</span>
<span class="n">A2</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">f2</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">A2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>

<span class="c1"># Make final sine wave</span>
<span class="n">vo</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span>
<span class="n">do_plots</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">vo</span><span class="p">)</span>
</pre></div>
</div>
<p>We can just add the two arrays, <code class="code highlight python docutils literal highlight-python"><span class="n">v1</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">v2</span></code>, together directly. Numpy will automatically add the corresponding elements in each array together to make a new array, <code class="code highlight python docutils literal highlight-python"><span class="n">vo</span></code>. This is much simpler than needing to write a <code class="code highlight python docutils literal highlight-python"><span class="k">for</span></code> loop to do the addition element by element. We just need to make sure that the arrays have the same number of elements in them so that the addition makes sense.</p>
</li>
<li><p>You should see a plot like the below. This is a 10 Hz sine wave with a smaller 50 Hz sine wave superimposed on top of it. 50 Hz is the mains frequency in the UK, so this sort of trace could be representing a low frequency signal with some mains interference on top of it. In the lab, it’s quite common that we see 50 Hz interference in our measurements.</p>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../../_images/sine_with_50hz.png"><img alt="Two plots of sine waves with plotly" src="../../_images/sine_with_50hz.png" width="800" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot of a web browser, software from <a class="reference external" href="https://brave.com/">Brave</a>. See <a class="reference external" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright">course copyright statement</a>.</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><p>We can make this signal model more realistic still by adding some random noise to it. Numpy provides a number of functions for this. We’ll use <code class="code highlight python docutils literal highlight-python"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span></code> to generate white Gaussian noise.</p>
<p>Add the below code to your file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add random noise</span>
<span class="n">noise_mean</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">noise_std</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># standard deviation of the noise, the peak-to-peak will be about 6 times this</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">noise_mean</span><span class="p">,</span> <span class="n">noise_std</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">vo</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vo_noisy</span> <span class="o">=</span> <span class="n">vo</span> <span class="o">+</span> <span class="n">noise</span>
<span class="n">do_plots</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">vo_noisy</span><span class="p">)</span>
</pre></div>
</div>
<p>This generates random noise with a mean of 0 and a standard deviation of 0.2, and then adds this to the signal. You should see a plot like the below.</p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../../_images/noisey_sine_wave.png"><img alt="Sine wave with noise plotted with plotly" src="../../_images/noisey_sine_wave.png" width="800" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot of a web browser, software from <a class="reference external" href="https://brave.com/">Brave</a>. See <a class="reference external" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright">course copyright statement</a>.</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</li>
<li><p>Let’s try another example. Using the time vector <code class="code highlight python docutils literal highlight-python"><span class="n">ts</span></code> defined below</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># sampling frequency in Hz</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<p>and <code class="code highlight python docutils literal highlight-python"><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span></code>, make a signal that follows the equation below. Run your code for different values of <span class="math notranslate nohighlight">\(n\)</span>. What does the signal look like as the value of <span class="math notranslate nohighlight">\(n\)</span> gets bigger?</p>
<div class="math notranslate nohighlight">
\[v(t) = \frac{4}{\pi} \sum_{k=1}^{n} \frac{1}{(2k-1)}\sin((2k-1) \times 2 \pi f t)\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># frequency in Hz</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of harmonics to add</span>
<span class="n">vs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span>
   <span class="n">ts</span>
<span class="p">)</span>  <span class="c1"># initialize v to be an array of zeros the same shape as t, lets us just add values to this in the for loop</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1">#  range doesn&#39;t include stop value</span>
   <span class="n">vs</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="p">(((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>
<span class="n">vs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">vs</span>  <span class="c1"># scale the final result</span>
<span class="n">do_plots</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">vs</span><span class="p">)</span>
</pre></div>
</div>
<p>As more terms are added, the signal looks more and more like a square wave. (This is an example of a Fourier series which you’ll learn about in your Maths course. Briefly, any periodic signal can be approximated by adding together sine waves of different frequencies and amplitudes.)</p>
<p>Numpy doesn’t have a function to make square waves directly, but scipy does. You can use <code class="code highlight python docutils literal highlight-python"><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">()</span></code> to make square waves more easily than the above.</p>
</div>
</li>
</ol>
</section>
<section id="array-slicing">
<h2><span class="section-number">4.2.1.4. </span>Array slicing<a class="headerlink" href="#array-slicing" title="Link to this heading">¶</a></h2>
<p>It’s common that we don’t want to work with an entire numpy array. It might have thousands, or millions of elements in it. An array can be <em>sliced</em> to access just a few elements in it. This uses square brackets <code class="code highlight python docutils literal highlight-python"><span class="p">[]</span></code> and numbers to indicate which elements we want to access. A colon <code class="code highlight python docutils literal highlight-python"><span class="p">:</span></code> is used to indicate a range of elements.</p>
<ol class="arabic">
<li><p>Make a time vector using the code below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># sampling frequency in Hz</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Work out the values of each of the below:</p>
<ul class="simple">
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code></p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span></code></p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span></code></p></li>
</ul>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<ul class="simple">
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code> is the first element in the array, 0.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code> is the second element, 0.002.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code> is the last element, 0.998.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span></code> is a new array containing the first 100 elements.</p></li>
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span></code> is a new array containing the last 100 elements. (If a number of either side of a colon <code class="code highlight python docutils literal highlight-python"><span class="p">:</span></code> is omitted Python takes all the values to or from the end of the array.)</p></li>
</ul>
</div>
</li>
</ol>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="lab_e.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span><span class="section-number">4.2. </span>Lab E
    </a>
    <a class="float-right" href="lab_e_stage_2.html" title="Next">
        <span class="section-number">4.2.2. </span>Scipy examples <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">4.2.1. Numpy examples</a><ul>
<li><a class="reference internal" href="#initial-setup-for-the-lab">4.2.1.1. Initial setup for the Lab</a></li>
<li><a class="reference internal" href="#numerical-analysis-in-python">4.2.1.2. Numerical analysis in Python</a></li>
<li><a class="reference internal" href="#simulating-signals-in-python">4.2.1.3. Simulating signals in Python</a></li>
<li><a class="reference internal" href="#array-slicing">4.2.1.4. Array slicing</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer id="uom_footer_info" class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://www.manchester.ac.uk/">The University of Manchester</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://canvas.manchester.ac.uk/">Canvas</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2026 The University of Manchester. <a class="nav-link text-light" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Released under CC-BY-NC-ND 4.0 license.</a> <a class="nav-link text-light" href="https://uom-eee-eeen11202.github.io/chapters/about/copyright.html">Course copyright statement.</a>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="../../_static/documentation_options.js?v=818a811f"></script>
        <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
        <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
        <script src="../../_static/translations.js?v=8fd896e3"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js"></script>
        <script>quizdown.init({"quizdown_js": "https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js", "start_on_load": true, "shuffle_answers": true, "shuffle_questions": false, "primary_color": "#660099", "secondary_color": "#DDDDDD", "text_color": "black", "locale": "en_GB", "enableRetry": true});</script>
        <script type="text/javascript" src="../../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../../_static/uom_custom.js"></script>
        <script type="text/javascript" src="../../_static/searchtools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("../../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>